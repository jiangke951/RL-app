{"ast":null,"code":"import { mapGetters } from 'vuex';\nexport default {\n  name: 'Feedback',\n  data() {\n    return {\n      feedbackFrom: {\n        info: ''\n      }\n    };\n  },\n  computed: {\n    ...mapGetters(['userinfo'])\n  },\n  methods: {\n    // 获取用户信息\n    async getUserInfo() {\n      try {\n        await this.$store.dispatch('getUserInfo', {\n          user_id: this.userinfo.user_id\n        });\n      } catch (e) {\n        console.warn(e.message);\n      }\n    },\n    // 重置表单\n    resetForm(formname) {\n      this.$refs[formname].resetFields();\n    },\n    // 提交\n    async handlerSubmit() {\n      const feedback_info = this.feedbackFrom.info;\n      const reg = /^[\\s\\S]{5,100}$/;\n      if (feedback_info.trim().length < 1) return;\n      if (feedback_info.trim().length > 0 && !reg.test(feedback_info)) {\n        return this.$message({\n          type: 'warning',\n          message: '请将反馈内容控制在5到100给个字符之间'\n        });\n      }\n      // 提交\n      await this.$confirm('确认提交?', '提示', {\n        confirmButtonText: '确定',\n        cancelButtonText: '取消',\n        type: 'warning'\n      }).then(async () => {\n        try {\n          const reqinfo = {\n            account: this.userinfo.account,\n            username: this.userinfo.username,\n            feedback_info\n          };\n          await this.$store.dispatch('sendFeedback', JSON.stringify(reqinfo)).then(res => {\n            this.$notify({\n              title: '提交成功',\n              type: 'success',\n              message: res\n            });\n            this.resetForm('feedbackFrom');\n          }).catch(err => this.$message({\n            type: 'warning',\n            message: err.message\n          }));\n        } catch (e) {\n          console.warn(e.message);\n        }\n      }).catch(() => {});\n    }\n  }\n};","map":{"version":3,"names":["mapGetters","name","data","feedbackFrom","info","computed","methods","getUserInfo","$store","dispatch","user_id","userinfo","e","console","warn","message","resetForm","formname","$refs","resetFields","handlerSubmit","feedback_info","reg","trim","length","test","$message","type","$confirm","confirmButtonText","cancelButtonText","then","reqinfo","account","username","JSON","stringify","res","$notify","title","catch","err"],"sources":["src/views/Index/Front/Feedback/index.vue"],"sourcesContent":["<template>\r\n    <div class=\"feedback maxWH\">\r\n        <!-- 头部 -->\r\n        <div class=\"header flex\">\r\n            <span class=\"title\">问题反馈</span>\r\n        </div>\r\n        <!-- 主体 -->\r\n        <main class=\"main\">\r\n            <!-- 介绍 -->\r\n            <div class=\"intro\">\r\n                <p class=\"flex-center\">在使用本系统中遇到了什么问题, 或者对于本系统有什么建议,</p>\r\n                <p class=\"flex-center\">又或者有什么想对开发者说的话, 等等, 都可以在这里提出来</p>\r\n            </div>\r\n            <!-- 表单 -->\r\n            <el-form class=\"from\" ref=\"feedbackFrom\" :model=\"feedbackFrom\" label-width=\"80px\" label-position=\"top\"\r\n                hide-required-asterisk>\r\n                <el-form-item label=\"问题反馈\" prop=\"info\">\r\n                    <el-input type=\"textarea\" v-model=\"feedbackFrom.info\" :rows=\"5\"></el-input>\r\n                </el-form-item>\r\n                <el-form-item align=\"center\">\r\n                    <el-button type=\"primary\" @click.native.prevent.stop=\"handlerSubmit\">提交</el-button>\r\n                    <el-button @click.native.prevent.stop=\"resetForm('feedbackFrom')\">重置</el-button>\r\n                </el-form-item>\r\n            </el-form>\r\n        </main>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\nimport { mapGetters } from 'vuex'\r\nexport default {\r\n    name: 'Feedback',\r\n    data() {\r\n        return {\r\n            feedbackFrom: {\r\n                info: ''\r\n            },\r\n        }\r\n    },\r\n    computed: {\r\n        ...mapGetters(['userinfo'])\r\n    },\r\n    methods: {\r\n        // 获取用户信息\r\n        async getUserInfo() {\r\n            try {\r\n                await this.$store.dispatch('getUserInfo', { user_id: this.userinfo.user_id })\r\n            } catch (e) {\r\n                console.warn(e.message)\r\n            }\r\n        },\r\n        // 重置表单\r\n        resetForm(formname) {\r\n            this.$refs[formname].resetFields()\r\n        },\r\n        // 提交\r\n        async handlerSubmit() {\r\n            const feedback_info = this.feedbackFrom.info\r\n            const reg = /^[\\s\\S]{5,100}$/\r\n            if (feedback_info.trim().length < 1) return\r\n            if (feedback_info.trim().length > 0 && !reg.test(feedback_info)) {\r\n                return this.$message({ type: 'warning', message: '请将反馈内容控制在5到100给个字符之间' })\r\n            }\r\n            // 提交\r\n            await this.$confirm('确认提交?', '提示', {\r\n                confirmButtonText: '确定',\r\n                cancelButtonText: '取消',\r\n                type: 'warning'\r\n            }).then(async () => {\r\n                try {\r\n                    const reqinfo = { account: this.userinfo.account, username: this.userinfo.username, feedback_info }\r\n                    await this.$store.dispatch('sendFeedback', JSON.stringify(reqinfo))\r\n                        .then(res => {\r\n                            this.$notify({ title: '提交成功', type: 'success', message: res })\r\n                            this.resetForm('feedbackFrom')\r\n                        })\r\n                        .catch(err => this.$message({ type: 'warning', message: err.message }))\r\n                } catch (e) {\r\n                    console.warn(e.message)\r\n                }\r\n            }).catch(() => { })\r\n        },\r\n    },\r\n}\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n.header {\r\n    width: 100%;\r\n    height: 100px;\r\n    background-color: #324057;\r\n    box-sizing: border-box;\r\n    padding: 50px 20% 10px;\r\n    overflow: hidden;\r\n\r\n    .title {\r\n        font-size: 25px;\r\n        color: #fff;\r\n    }\r\n}\r\n\r\n.main {\r\n    width: 100%;\r\n    height: calc(100% - 100px);\r\n    box-sizing: border-box;\r\n    padding: 50px 20% 0;\r\n\r\n    .intro {\r\n        p {\r\n            font-size: 18px;\r\n        }\r\n    }\r\n\r\n    .from {\r\n        box-sizing: border-box;\r\n        padding: 50px 20% 0;\r\n    }\r\n}\r\n</style>"],"mappings":"AA6BA,SAAAA,UAAA;AACA;EACAC,IAAA;EACAC,KAAA;IACA;MACAC,YAAA;QACAC,IAAA;MACA;IACA;EACA;EACAC,QAAA;IACA,GAAAL,UAAA;EACA;EACAM,OAAA;IACA;IACA,MAAAC,YAAA;MACA;QACA,WAAAC,MAAA,CAAAC,QAAA;UAAAC,OAAA,OAAAC,QAAA,CAAAD;QAAA;MACA,SAAAE,CAAA;QACAC,OAAA,CAAAC,IAAA,CAAAF,CAAA,CAAAG,OAAA;MACA;IACA;IACA;IACAC,UAAAC,QAAA;MACA,KAAAC,KAAA,CAAAD,QAAA,EAAAE,WAAA;IACA;IACA;IACA,MAAAC,cAAA;MACA,MAAAC,aAAA,QAAAlB,YAAA,CAAAC,IAAA;MACA,MAAAkB,GAAA;MACA,IAAAD,aAAA,CAAAE,IAAA,GAAAC,MAAA;MACA,IAAAH,aAAA,CAAAE,IAAA,GAAAC,MAAA,SAAAF,GAAA,CAAAG,IAAA,CAAAJ,aAAA;QACA,YAAAK,QAAA;UAAAC,IAAA;UAAAZ,OAAA;QAAA;MACA;MACA;MACA,WAAAa,QAAA;QACAC,iBAAA;QACAC,gBAAA;QACAH,IAAA;MACA,GAAAI,IAAA;QACA;UACA,MAAAC,OAAA;YAAAC,OAAA,OAAAtB,QAAA,CAAAsB,OAAA;YAAAC,QAAA,OAAAvB,QAAA,CAAAuB,QAAA;YAAAb;UAAA;UACA,WAAAb,MAAA,CAAAC,QAAA,iBAAA0B,IAAA,CAAAC,SAAA,CAAAJ,OAAA,GACAD,IAAA,CAAAM,GAAA;YACA,KAAAC,OAAA;cAAAC,KAAA;cAAAZ,IAAA;cAAAZ,OAAA,EAAAsB;YAAA;YACA,KAAArB,SAAA;UACA,GACAwB,KAAA,CAAAC,GAAA,SAAAf,QAAA;YAAAC,IAAA;YAAAZ,OAAA,EAAA0B,GAAA,CAAA1B;UAAA;QACA,SAAAH,CAAA;UACAC,OAAA,CAAAC,IAAA,CAAAF,CAAA,CAAAG,OAAA;QACA;MACA,GAAAyB,KAAA;IACA;EACA;AACA"},"metadata":{},"sourceType":"module","externalDependencies":[]}